import{e as Ve,$ as je,R as Q,r as n,u as ve,m as be,j as e,c as u,U as Oe,C as Ge,a as Qe,b as o,H as w,T as f,d as Ye,B as I,L as qe,M as Xe,S as Ke,f as Je,g as _e,h as z,i as et,I as E,k as y,W as tt,N as rt,E as ot,F as $,l as at,n as nt,o as st,p as lt,Q as Le,q as it,s as ct,t as xe,v as j,w as dt,x as O,y as Ce,z as G,A as pt,D as ht,G as ut,J as mt,X as Ee,K as ft,O as gt,P as ye,V as Me,Y as bt,Z as Ue,_ as ze,a0 as te,a1 as Re,a2 as xt,a3 as Ct,a4 as yt,a5 as Fe,a6 as kt,a7 as wt,a8 as R,a9 as F,aa as St,ab as It,ac as vt,ad as _t,ae as Lt,af as Ae,ag as Et,ah as Mt,ai as re,aj as oe,ak as ae,al as ne,am as se,an as le,ao as Be,ap as Ut,aq as zt,ar as L,as as Rt,at as Te,au as We,av as T,aw as q,ax as Ft,ay as At,az as K,aA as J,aB as Bt,aC as Tt,aD as Wt,aE as Dt,aF as Pt,aG as Ht,aH as Zt,aI as $t,aJ as Nt,aK as Vt,aL as jt,aM as Ot,aN as Gt,aO as Qt,aP as Yt}from"./vendor.57722b1b.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const l of c.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function a(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerpolicy&&(c.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?c.credentials="include":s.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(s){if(s.ep)return;s.ep=!0;const c=a(s);fetch(s.href,c)}})();const qt=Ve({shadows:{outline:"0 0 0 2px var(--chakra-colors-primary-200)"},fonts:{body:"Inter,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif"},colors:{"light-border":"#d2d2d4",primary:{50:"#9cb7f2",100:"#88a9ef",200:"#749aec",300:"#618ce9",400:"#4d7de7",500:"#396fe4",600:"#3364cd",700:"#2e59b6",800:"#284ea0",900:"#224389"},gray:{750:"#222C3B"}},components:{Alert:{baseStyle:{container:{borderRadius:"6px",fontSize:"sm"}}},Select:{baseStyle:{field:{_dark:{borderColor:"gray.600"}}}},FormHelperText:{baseStyle:{fontSize:"xs"}},FormLabel:{baseStyle:{fontSize:"sm",fontWeight:"medium",mb:"1",_dark:{color:"gray.300"}}},Input:{baseStyle:{addon:{_dark:{borderColor:"gray.600",_placeholder:{color:"gray.500"}}},field:{_focusVisible:{boxShadow:"none",borderColor:"primary.200",outlineColor:"primary.200"},_dark:{borderColor:"gray.600",_disabled:{borderColor:"gray.500"},_placeholder:{color:"gray.500"}}}}},Table:{baseStyle:{table:{borderCollapse:"separate",borderSpacing:0},thead:{borderBottomColor:"light-border"},th:{background:"#F9FAFB",borderColor:"light-border !important",borderBottomColor:"light-border !important",borderTop:"1px solid ",borderTopColor:"light-border !important",_first:{borderLeft:"1px solid",borderColor:"light-border !important"},_last:{borderRight:"1px solid",borderColor:"light-border !important"},_dark:{borderColor:"gray.600 !important",background:"gray.750"}},td:{transition:"all .1s ease-out",borderColor:"light-border",borderBottomColor:"light-border !important",_first:{borderLeft:"1px solid",borderColor:"light-border",_dark:{borderColor:"gray.600"}},_last:{borderRight:"1px solid",borderColor:"light-border",_dark:{borderColor:"gray.600"}},_dark:{borderColor:"gray.600",borderBottomColor:"gray.600 !important"}},tr:{"&.interactive":{cursor:"pointer",_hover:{"& > td":{bg:"gray.200"},_dark:{"& > td":{bg:"gray.750"}}}},_last:{"& > td":{_first:{borderBottomLeftRadius:"8px"},_last:{borderBottomRightRadius:"8px"}}}}}}}});const ee=()=>localStorage.getItem("token"),Xt=t=>{localStorage.setItem("token",t)},Kt=je.create({baseURL:"/api/"}),De=(t,r={})=>(ee()&&(r.headers={...(r==null?void 0:r.headers)||{},Authorization:`Bearer ${ee()}`}),Kt(t,r)),P=De,Pe={editingUser:null,deletingUser:null,isCreatingNewUser:!1,qrcodeLinks:null,users:[],filteredUsers:[],loading:!0,filters:{search:""},onCreateUser:()=>{},onEditingUser:t=>{},onDeletingUser:t=>{},refetchUsers:()=>{},onFilterChange:t=>{},setQRCode:t=>{},deleteUser:t=>new Promise(()=>{}),createUser:t=>new Promise(()=>{}),editUser:t=>new Promise(()=>{})},He=Q.createContext(Pe),A=()=>n.exports.useContext(He),Jt=(t,r)=>{switch(r.type){case"CreatingNewUser":return{...t,isCreatingNewUser:r.isOpen};case"EditingUser":return{...t,editingUser:r.user};case"DeletingUser":return{...t,deletingUser:r.user};case"FilterChange":return{...t,filters:r.filters};case"SetQrCode":return{...t,qrcodeLinks:r.links};default:return t}},er=({children:t})=>{const[r,a]=n.exports.useReducer(Jt,Pe),{data:i,isValidating:s,mutate:c}=ve("/users"),l=n.exports.useCallback(h=>{a({type:"CreatingNewUser",isOpen:h})},[]),d=n.exports.useCallback(()=>{c()},[]),p=n.exports.useCallback(h=>{a({type:"EditingUser",user:h})},[]),x=n.exports.useCallback(h=>{a({type:"DeletingUser",user:h})},[]),k=n.exports.useCallback(h=>{a({type:"FilterChange",filters:h})},[]),g=n.exports.useCallback(h=>(p(null),P(`/user/${h.username}`,{method:"DELETE"}).then(()=>{x(null),d(),be("/system")})),[]),v=n.exports.useCallback(h=>P("/user",{method:"POST",body:h}).then(()=>{p(null),d(),be("/system")}),[]),S=n.exports.useCallback(h=>P(`/user/${h.username}`,{method:"PUT",body:h}).then(()=>{p(null),d()}),[]),m=n.exports.useCallback(h=>{a({type:"SetQrCode",links:h})},[]),M=n.exports.useMemo(()=>i?i.filter(h=>h.username.indexOf(r.filters.search)>-1):[],[r.filters,i]),W={...r,users:i||[],filteredUsers:M,loading:s,refetchUsers:d,onEditingUser:p,onDeletingUser:x,onCreateUser:l,onFilterChange:k,deleteUser:g,createUser:v,editUser:S,setQRCode:m};return e(He.Provider,{value:W,children:t})};function H(t,r=2){if(!+t)return"0 B";const a=1024,i=r<0?0:r,s=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c=Math.floor(Math.log(t)/Math.log(a));return`${parseFloat((t/Math.pow(a,c)).toFixed(i))} ${s[c]}`}const tr=t=>{if(t)return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},rr=u(Oe,{baseStyle:{w:5,h:5,position:"relative",zIndex:"2"}}),or=u(Ge,{baseStyle:{w:5,h:5,position:"relative",zIndex:"2"}}),ar=u(Qe,{baseStyle:{w:5,h:5,position:"relative",zIndex:"2"}}),X=({title:t,content:r,icon:a})=>o(Ye,{p:6,borderWidth:"1px",borderColor:"light-border",bg:"#F9FAFB",_dark:{borderColor:"gray.600",bg:"gray.750"},borderStyle:"solid",boxShadow:"none",borderRadius:"12px",width:"full",display:"flex",justifyContent:"space-between",flexDirection:"row",children:[o(w,{alignItems:"center",experimental_spaceX:"4",children:[e(I,{p:"2",position:"relative",color:"white",_before:{content:'""',position:"absolute",top:0,left:0,bg:"primary.400",display:"block",w:"full",h:"full",borderRadius:"5px",opacity:".5",z:"1"},_after:{content:'""',position:"absolute",top:"-5px",left:"-5px",bg:"primary.400",display:"block",w:"calc(100% + 10px)",h:"calc(100% + 10px)",borderRadius:"8px",opacity:".4",z:"1"},children:a}),e(f,{color:"gray.600",_dark:{color:"gray.300"},fontWeight:"medium",textTransform:"capitalize",fontSize:"sm",children:t})]}),e(I,{fontSize:"3xl",fontWeight:"semibold",mt:"2",children:r})]}),nr=t=>{const{data:r}=ve("/system",{revalidateIfStale:!0,revalidateOnFocus:!0,revalidateOnReconnect:!0,refreshInterval:5e3});return o(w,{justifyContent:"space-between",gap:0,experimental_spaceX:{lg:"4",md:"0"},experimental_spaceY:{lg:"0",base:"4"},display:{lg:"flex",md:"block"},...t,children:[e(X,{title:"total users",content:r&&tr(r.total_user),icon:e(rr,{})}),e(X,{title:"bandwidth usage",content:r&&H(r.incoming_bandwidth+r.outgoing_bandwith),icon:e(or,{})}),e(X,{title:"memory usage",content:r&&o(w,{alignItems:"center",children:[e(f,{children:H(r.mem_used,1)}),o(f,{fontWeight:"normal",fontSize:"lg",as:"span",children:["/ ",H(r.mem_total,1)]})]}),icon:e(ar,{})})]})},sr=u(qe),lr=u(Xe,{baseStyle:{w:"4",h:"4"}}),ir=u(Ke,{baseStyle:{w:"4",h:"4"}}),Ze=t=>{const{colorMode:r,toggleColorMode:a}=Je(),i=_e();return o(w,{w:"full",py:"0",position:"relative",...t,children:[i.pathname!=="/login"&&e(sr,{to:"/login",left:"0",position:"absolute",children:e(z,{size:"sm",children:"Log out"})}),o(f,{display:"inline-block",flexGrow:1,textAlign:"center",color:"gray.500",fontSize:"xs",children:["Made with \u2764\uFE0F in"," ",e(et,{color:"blue.400",href:"https://github.com/gozargah",children:"Gozargah"})]}),e(E,{size:"sm","aria-label":"switch theme",onClick:a,position:"absolute",right:"0",children:r==="light"?e(lr,{}):e(ir,{})})]})},cr=({actions:t})=>o(w,{gap:2,justifyContent:"space-between",children:[e(f,{as:"h1",fontWeight:"semibold",fontSize:"2xl",children:"Users"}),t&&e(I,{children:t})]}),dr=t=>n.exports.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","data-name":"Layer 1",width:782.04441,height:701.88002,viewBox:"0 0 782.04441 701.88002",xmlnsXlink:"http://www.w3.org/1999/xlink",...t},n.exports.createElement("path",{d:"M609.48783,100.59015l-25.44631,6.56209L270.53735,187.9987,245.091,194.56079A48.17927,48.17927,0,0,0,210.508,253.17865L320.849,681.05606a48.17924,48.17924,0,0,0,58.61776,34.58317l.06572-.01695,364.26536-93.93675.06572-.01695a48.17923,48.17923,0,0,0,34.58309-58.6178l-110.341-427.87741A48.17928,48.17928,0,0,0,609.48783,100.59015Z",transform:"translate(-208.9778 -99.05999)",fill:"#f2f2f2"}),n.exports.createElement("path",{d:"M612.94784,114.00532l-30.13945,7.77236L278.68955,200.20385l-30.139,7.77223a34.30949,34.30949,0,0,0-24.6275,41.74308l110.341,427.87741a34.30946,34.30946,0,0,0,41.7431,24.62736l.06572-.01695,364.26536-93.93674.06619-.01707a34.30935,34.30935,0,0,0,24.627-41.7429l-110.341-427.87741A34.30938,34.30938,0,0,0,612.94784,114.00532Z",transform:"translate(-208.9778 -99.05999)",fill:"#fff"}),n.exports.createElement("path",{d:"M590.19,252.56327,405.917,300.08359a8.01411,8.01411,0,0,1-4.00241-15.52046l184.273-47.52033A8.01412,8.01412,0,0,1,590.19,252.56327Z",transform:"translate(-208.9778 -99.05999)",fill:"#f2f2f2"}),n.exports.createElement("path",{d:"M628.955,270.49906,412.671,326.27437a8.01411,8.01411,0,1,1-4.00241-15.52046l216.284-55.77531a8.01411,8.01411,0,0,1,4.00242,15.52046Z",transform:"translate(-208.9778 -99.05999)",fill:"#f2f2f2"}),n.exports.createElement("path",{d:"M620.45825,369.93676l-184.273,47.52032a8.01411,8.01411,0,1,1-4.00242-15.52046l184.273-47.52032a8.01411,8.01411,0,1,1,4.00241,15.52046Z",transform:"translate(-208.9778 -99.05999)",fill:"#f2f2f2"}),n.exports.createElement("path",{d:"M659.22329,387.87255l-216.284,55.77531a8.01411,8.01411,0,1,1-4.00242-15.52046l216.284-55.77531a8.01411,8.01411,0,0,1,4.00242,15.52046Z",transform:"translate(-208.9778 -99.05999)",fill:"#f2f2f2"}),n.exports.createElement("path",{d:"M650.72653,487.31025l-184.273,47.52033a8.01412,8.01412,0,0,1-4.00242-15.52047l184.273-47.52032a8.01411,8.01411,0,0,1,4.00242,15.52046Z",transform:"translate(-208.9778 -99.05999)",fill:"#f2f2f2"}),n.exports.createElement("path",{d:"M689.49156,505.246l-216.284,55.77532a8.01412,8.01412,0,1,1-4.00241-15.52047l216.284-55.77531a8.01411,8.01411,0,0,1,4.00242,15.52046Z",transform:"translate(-208.9778 -99.05999)",fill:"#f2f2f2"}),n.exports.createElement("path",{d:"M374.45884,348.80871l-65.21246,16.817a3.847,3.847,0,0,1-4.68062-2.76146L289.5963,304.81607a3.847,3.847,0,0,1,2.76145-4.68061l65.21247-16.817a3.847,3.847,0,0,1,4.68061,2.76145l14.96947,58.04817A3.847,3.847,0,0,1,374.45884,348.80871Z",transform:"translate(-208.9778 -99.05999)",fill:"#e6e6e6"}),n.exports.createElement("path",{d:"M404.72712,466.1822l-65.21247,16.817a3.847,3.847,0,0,1-4.68062-2.76146l-14.96946-58.04816A3.847,3.847,0,0,1,322.626,417.509l65.21246-16.817a3.847,3.847,0,0,1,4.68062,2.76145l14.96946,58.04817A3.847,3.847,0,0,1,404.72712,466.1822Z",transform:"translate(-208.9778 -99.05999)",fill:"#e6e6e6"}),n.exports.createElement("path",{d:"M434.99539,583.55569l-65.21246,16.817a3.847,3.847,0,0,1-4.68062-2.76145l-14.96946-58.04817a3.847,3.847,0,0,1,2.76145-4.68062l65.21247-16.817a3.847,3.847,0,0,1,4.68061,2.76146l14.96947,58.04816A3.847,3.847,0,0,1,434.99539,583.55569Z",transform:"translate(-208.9778 -99.05999)",fill:"#e6e6e6"}),n.exports.createElement("path",{d:"M863.63647,209.0517H487.31811a48.17928,48.17928,0,0,0-48.125,48.12512V699.05261a48.17924,48.17924,0,0,0,48.125,48.12507H863.63647a48.17924,48.17924,0,0,0,48.125-48.12507V257.17682A48.17928,48.17928,0,0,0,863.63647,209.0517Z",transform:"translate(-208.9778 -99.05999)",fill:"#e6e6e6"}),n.exports.createElement("path",{d:"M863.637,222.90589H487.31811a34.30948,34.30948,0,0,0-34.271,34.27093V699.05261a34.30947,34.30947,0,0,0,34.271,34.27088H863.637a34.30936,34.30936,0,0,0,34.27051-34.27088V257.17682A34.30937,34.30937,0,0,0,863.637,222.90589Z",transform:"translate(-208.9778 -99.05999)",fill:"#fff"}),n.exports.createElement("circle",{cx:694.19401,cy:614.02963,r:87.85039,fill:"#3182CE"}),n.exports.createElement("path",{d:"M945.18722,701.63087H914.63056V671.07421a11.45875,11.45875,0,0,0-22.9175,0v30.55666H861.1564a11.45875,11.45875,0,0,0,0,22.9175h30.55666V755.105a11.45875,11.45875,0,1,0,22.9175,0V724.54837h30.55666a11.45875,11.45875,0,0,0,0-22.9175Z",transform:"translate(-208.9778 -99.05999)",fill:"#fff"}),n.exports.createElement("path",{d:"M807.00068,465.71551H616.699a8.01412,8.01412,0,1,1,0-16.02823H807.00068a8.01412,8.01412,0,0,1,0,16.02823Z",transform:"translate(-208.9778 -99.05999)",fill:"#e6e6e6"}),n.exports.createElement("path",{d:"M840.05889,492.76314H616.699a8.01412,8.01412,0,1,1,0-16.02823H840.05889a8.01411,8.01411,0,1,1,0,16.02823Z",transform:"translate(-208.9778 -99.05999)",fill:"#e6e6e6"}),n.exports.createElement("path",{d:"M807.00068,586.929H616.699a8.01412,8.01412,0,1,1,0-16.02823H807.00068a8.01411,8.01411,0,0,1,0,16.02823Z",transform:"translate(-208.9778 -99.05999)",fill:"#e6e6e6"}),n.exports.createElement("path",{d:"M840.05889,613.97661H616.699a8.01412,8.01412,0,1,1,0-16.02823H840.05889a8.01412,8.01412,0,1,1,0,16.02823Z",transform:"translate(-208.9778 -99.05999)",fill:"#e6e6e6"}),n.exports.createElement("path",{d:"M574.07028,505.04162H506.72434a3.847,3.847,0,0,1-3.84278-3.84278V441.25158a3.847,3.847,0,0,1,3.84278-3.84278h67.34594a3.847,3.847,0,0,1,3.84278,3.84278v59.94726A3.847,3.847,0,0,1,574.07028,505.04162Z",transform:"translate(-208.9778 -99.05999)",fill:"#e6e6e6"}),n.exports.createElement("path",{d:"M574.07028,626.25509H506.72434a3.847,3.847,0,0,1-3.84278-3.84278V562.46505a3.847,3.847,0,0,1,3.84278-3.84278h67.34594a3.847,3.847,0,0,1,3.84278,3.84278v59.94726A3.847,3.847,0,0,1,574.07028,626.25509Z",transform:"translate(-208.9778 -99.05999)",fill:"#e6e6e6"}),n.exports.createElement("path",{d:"M807.21185,330.781H666.91017a8.01411,8.01411,0,0,1,0-16.02823H807.21185a8.01411,8.01411,0,0,1,0,16.02823Z",transform:"translate(-208.9778 -99.05999)",fill:"#ccc"}),n.exports.createElement("path",{d:"M840.27007,357.82862H666.91017a8.01411,8.01411,0,1,1,0-16.02822h173.3599a8.01411,8.01411,0,0,1,0,16.02822Z",transform:"translate(-208.9778 -99.05999)",fill:"#ccc"}),n.exports.createElement("path",{d:"M635.85911,390.6071H506.51316a3.847,3.847,0,0,1-3.84277-3.84277V285.81706a3.847,3.847,0,0,1,3.84277-3.84277H635.85911a3.847,3.847,0,0,1,3.84277,3.84277V386.76433A3.847,3.847,0,0,1,635.85911,390.6071Z",transform:"translate(-208.9778 -99.05999)",fill:"#ccc"})),$e=t=>{let r="";return t&&(y(t*1e3).utc().isAfter(y().utc())?r="Expires "+y().to(y(t*1e3).utc()):r="Expired "+y().from(y(t*1e3).utc())),r},ie={baseStyle:{strokeWidth:"2px",w:4,h:4}},pr=u(tt,ie),hr=u(rt,ie),ur=u(ot,ie),mr={active:{statusColor:"green",bandWidthColor:"green"},expired:{statusColor:"gray",bandWidthColor:"gray"},limited:{statusColor:"red",bandWidthColor:"red"}},fr=({expiryDate:t,status:r})=>{let a=$e(t);return o($,{children:[o(at,{colorScheme:mr[r].statusColor,rounded:"full",display:"inline-flex",px:3,py:1,experimental_spaceX:2,alignItems:"center",children:[r==="active"&&e(pr,{}),r==="limited"&&e(hr,{}),r==="expired"&&e(ur,{}),e(f,{textTransform:"capitalize",fontSize:".875rem",lineHeight:"1.25rem",fontWeight:"medium",letterSpacing:"tighter",children:r})]}),t&&e(f,{display:"inline-block",fontSize:"xs",fontWeight:"medium",ml:"2",color:"gray.600",_dark:{color:"gray.400"},children:a})]})},gr=u(dr),Y={baseStyle:{w:5,h:5}},br=u(nt,Y),ke=u(st,Y),xr=u(lt,Y),Cr=u(Le,Y),yr=t=>{const{used:r,total:a,...i}=t,s=a===0||a===null,c=!s&&r/a*100>=100;return o($,{children:[e(pt,{orientation:"horizontal",value:s?100:Math.min(r/a*100,100),colorScheme:c?"red":"primary",...i,children:e(ht,{h:"6px",borderRadius:"full",children:e(ut,{borderRadius:"full"})})}),o(f,{fontSize:"xs",fontWeight:"medium",color:"gray.600",_dark:{color:"gray.400"},children:[H(r)," /"," ",s?e(f,{as:"span",fontFamily:"system-ui",children:"\u221E"}):H(a)]})]})},kr=t=>{const{filteredUsers:r,users:a,onEditingUser:i,setQRCode:s}=A(),c=r.length!==a.length,[l,d]=n.exports.useState([-1,-1,!1]);return n.exports.useEffect(()=>{l[2]&&setTimeout(()=>{d([-1,-1,!1])},1e3)},[l]),o(I,{overflowX:"auto",maxW:"100vw",children:[o(it,{...t,children:[e(ct,{children:o(xe,{children:[e(j,{children:"Username"}),e(j,{children:"status"}),e(j,{children:"banding usage"}),e(j,{})]})}),e(dt,{children:r==null?void 0:r.map((p,x)=>{const k=p.links.join(`\r
`);return o(xe,{className:"interactive",onClick:()=>i(p),children:[e(O,{minW:"150px",children:p.username}),e(O,{width:"350px",children:e(fr,{expiryDate:p.expire,status:p.status})}),e(O,{width:"300px",minW:"200px",children:e(yr,{used:p.used_traffic,total:p.data_limit,colorScheme:p.status==="limited"?"red":"primary"})}),e(O,{width:"150px",children:o(w,{justifyContent:"flex-end",onClick:g=>{g.preventDefault(),g.stopPropagation()},children:[e(Ce,{text:p.subscription_url.startsWith("/")?window.location.origin+p.subscription_url:p.subscription_url,onCopy:()=>{d([x,0,!0])},children:e("div",{children:e(G,{label:l[0]===x&&l[1]==0&&l[2]?"Copied":"Copy Subscription Link",placement:"top",children:e(E,{"aria-label":"copy subscription link",bg:"transparent",_dark:{_hover:{bg:"gray.700"}},children:l[0]===x&&l[1]==0&&l[2]?e(ke,{}):e(xr,{})})})})}),e(Ce,{text:k,onCopy:()=>{d([x,1,!0])},children:e("div",{children:e(G,{label:l[0]===x&&l[1]==1&&l[2]?"Copied":"Copy Configs",placement:"top",children:e(E,{"aria-label":"copy configs",bg:"transparent",_dark:{_hover:{bg:"gray.700"}},children:l[0]===x&&l[1]==1&&l[2]?e(ke,{}):e(br,{})})})})}),e(G,{label:"QR Code",placement:"top",children:e(E,{"aria-label":"qr code",bg:"transparent",_dark:{_hover:{bg:"gray.700"}},onClick:()=>{s(p.links)},children:e(Cr,{})})})]})})]},p.username)})})]}),r.length==0&&e(wr,{isFiltered:c})]})},wr=({isFiltered:t})=>{const{onCreateUser:r}=A();return o(I,{borderWidth:"1px",borderStyle:"solid",borderTop:0,borderBottomRadius:"8px",padding:"5",_dark:{borderColor:"gray.600"},py:"8",display:"flex",alignItems:"center",flexDirection:"column",experimental_spaceY:4,children:[e(gr,{maxHeight:"200px",maxWidth:"200px",_dark:{'path[fill="#fff"]':{fill:"gray.800"},'path[fill="#f2f2f2"], path[fill="#e6e6e6"], path[fill="#ccc"]':{fill:"gray.700"},'circle[fill="#3182CE"]':{fill:"primary.300"}},_light:{'path[fill="#f2f2f2"], path[fill="#e6e6e6"], path[fill="#ccc"]':{fill:"gray.300"},'circle[fill="#3182CE"]':{fill:"primary.500"}}}),e(f,{fontWeight:"medium",color:"gray.600",_dark:{color:"gray.400"},children:t?"It seems there is no user matched with what you are looking for":"There is no user added to the system"}),!t&&e(z,{size:"sm",colorScheme:"primary",onClick:()=>r(!0),children:"Create user"})]})},ce={baseStyle:{w:4,h:4}},Sr=u(mt,ce),Ir=u(Ee,ce),vr=u(ft,ce),_r=({...t})=>{const{loading:r,filters:a,onFilterChange:i,refetchUsers:s}=A(),c=d=>{i({...a,search:d.target.value})},l=()=>{i({...a,search:""})};return o(gt,{templateColumns:{lg:"repeat(3, 1fr)",base:"repeat(1, 1fr)"},gap:4,...t,children:[e(ye,{colSpan:1,children:o(Me,{children:[e(bt,{pointerEvents:"none",children:e(Sr,{})}),e(Ue,{type:"tel",placeholder:"Search",value:a.search||"",borderColor:"light-border",onChange:c}),o(ze,{children:[r&&e(te,{size:"xs"}),a.search.length>0&&e(E,{onClick:l,"aria-label":"clear",size:"xs",variant:"ghost",children:e(Ir,{})})]})]})}),e(ye,{colSpan:2,children:e(w,{justifyContent:"flex-end",alignItems:"center",h:"full",children:e(E,{"aria-label":"refresh users",disabled:r,onClick:s,size:"sm",children:e(vr,{className:Re({"animate-spin":r})})})})})]})},de=({children:t,color:r})=>e(I,{position:"relative",width:"36px",height:"36px",display:"flex",justifyContent:"center",alignItems:"center",_before:{content:'""',display:"block",position:"absolute",top:"0",left:"0",width:"calc(100%)",height:"calc(100%)",bg:`${r}.400`,opacity:".5",borderRadius:"5px",zIndex:"1",_dark:{bg:`${r}.400`}},_after:{content:'""',display:"block",position:"absolute",top:"0",left:"0",width:"calc(100% + 10px)",height:"calc(100% + 10px)",transform:"translate(-5px, -5px)",bg:`${r}.400`,opacity:".4",borderRadius:"8px",zIndex:"1",_dark:{bg:`${r}.400`}},children:e(f,{color:`${r}.500`,_dark:{color:`${r}.900`},position:"relative",zIndex:"2",children:t})}),Lr=u(xt,{baseStyle:{strokeWidth:"2px",w:5,h:5}}),Er=u(Ct,{baseStyle:{strokeWidth:"2px",w:5,h:5}}),Mr=({disabled:t,title:r,description:a,...i})=>{const{getCheckboxProps:s,getInputProps:c,getLabelProps:l,htmlProps:d}=kt(i);return o(I,{as:"label",children:[e("input",{...c()}),o(I,{w:"fll",position:"relative",...d,cursor:"pointer",borderRadius:"md",border:"1px solid",borderColor:"gray.200",_dark:{borderColor:"gray.600"},_checked:{bg:"gray.50",outline:"2px",boxShadow:"outline",outlineColor:"primary.500",borderColor:"transparent",fontWeight:"medium",_dark:{bg:"gray.750",borderColor:"transparent"},"& > svg":{opacity:1,"&.checked":{display:"block"},"&.unchecked":{display:"none"}},"& p":{opacity:1}},__css:{"& > svg":{opacity:.3,"&.checked":{display:"none"},"&.unchecked":{display:"block"}},"& p":{opacity:.8}},textTransform:"capitalize",px:3,py:2,fontWeight:"medium",...s(),children:[e(Lr,{className:"checked",color:"primary.200",position:"absolute",right:"3",top:"3"}),e(Er,{className:"unchecked",color:"primary.200",position:"absolute",right:"3",top:"3"}),e(f,{fontSize:"sm",color:"gray.700",_dark:{color:"gray.300"},...l(),children:r}),e(f,{fontWeight:"medium",color:"gray.600",_dark:{color:"gray.400"},fontSize:"xs",children:a})]})]})},Ur=n.exports.forwardRef(({name:t,list:r,onChange:a,disabled:i,...s},c)=>{const{getCheckboxProps:l}=yt({defaultValue:s.value,onChange:d=>{a({target:{value:d,name:t}})}});return e(Fe,{ref:c,experimental_spaceY:1,alignItems:"flex-start",columns:1,spacing:1,children:r.map(d=>e(Mr,{disabled:i,title:d.title,description:d.description,...l({value:d.title})},d.title))})}),zr=u(Ee,{baseStyle:{w:4,h:4}}),Z=Q.forwardRef(({disabled:t,step:r,label:a,className:i,startAdornment:s,endAdornment:c,type:l="text",placeholder:d,onChange:p,onBlur:x,name:k,value:g,onClick:v,error:S,clearable:m=!1,...M},W)=>{const h=()=>{p&&p({target:{value:"",name:k}})},{size:D="md"}=M,N=l=="number"?Et:Ue,V=l=="number"?wt:Q.Fragment,b=l=="number"?{name:k,type:l,placeholder:d,onChange:U=>{p&&p(U)},onBlur:x,value:g,onClick:v,disabled:t,flexGrow:1,size:D}:{};return o(R,{isInvalid:!!S,children:[a&&e(F,{children:a}),o(Me,{size:D,w:"full",rounded:"md",_focusWithin:{outline:"2px solid",outlineColor:"primary.200"},bg:t?"gray.100":"transparent",_dark:{bg:t?"gray.600":"transparent"},children:[s&&e(St,{children:s}),o(V,{...b,children:[e(N,{name:k,ref:W,step:r,className:Re(i),type:l,placeholder:d,onChange:p,onBlur:x,value:g,onClick:v,disabled:t,roundedLeft:s?"0":"md",roundedRight:c?"0":"md",flexGrow:1,_focusVisible:{outline:"none",borderTopColor:"transparent",borderRightColor:"transparent",borderBottomColor:"transparent"},_disabled:{cursor:"not-allowed"},...M}),l=="number"&&e($,{children:o(It,{children:[e(vt,{}),e(_t,{})]})})]}),c&&e(Lt,{borderRadius:"6px",bg:"transparent",children:c}),m&&g&&g.length&&e(ze,{borderRadius:"6px",bg:"transparent",onClick:h,cursor:"pointer",children:e(zr,{})})]}),!!S&&e(Ae,{children:S})]})}),Ne=u(Mt,{baseStyle:{w:5,h:5}}),Rr=()=>{const[t,r]=n.exports.useState(!1),{deletingUser:a,onDeletingUser:i,deleteUser:s}=A(),c=()=>{i(null)},l=()=>{a&&(r(!0),s(a).then(c).finally(r.bind(null,!1)))};return o(re,{isCentered:!0,isOpen:!!a,onClose:c,size:"sm",children:[e(oe,{bg:"blackAlpha.300",backdropFilter:"blur(10px)"}),o(ae,{mx:"3",children:[e(ne,{pt:6,children:e(de,{color:"red",children:e(Ne,{})})}),e(se,{mt:3}),o(le,{children:[e(f,{fontWeight:"semibold",fontSize:"lg",children:"Delete user"}),a&&o(f,{mt:1,fontSize:"sm",_dark:{color:"gray.400"},color:"gray.600",children:["Are you sure you want to delete ",e("b",{children:a.username}),"?"]})]}),o(Be,{display:"flex",children:[e(z,{size:"sm",onClick:c,mr:3,w:"full",variant:"outline",children:"Cancel"}),e(z,{size:"sm",w:"full",colorScheme:"red",onClick:l,leftIcon:t?e(te,{size:"xs"}):void 0,children:"Delete"})]})]})]})},Fr=u(Ut,{baseStyle:{w:5,h:5}}),Ar=u(zt,{baseStyle:{w:5,h:5}}),Br=L.object({username:L.string().min(1,{message:"Required"}),proxies:L.array(L.string()).refine(t=>t.length>0,{message:"Please select at least one protocol"}),data_limit:L.number().min(0,"The minimum number is 0").nullable(),expire:L.number().nullable()}),we=t=>({...t,proxies:Object.keys(t.proxies)}),Se=()=>({proxies:["vmess","vless","trojan"],data_limit:null,expire:null,username:""}),Tr=(t,r)=>{const a=t.reduce((i,s)=>({...i,[s]:{}}),{});return r&&t.forEach(i=>{r[i]&&(a[i]=r[i])}),a},Wr=()=>{var D,N,V;const{editingUser:t,isCreatingNewUser:r,onCreateUser:a,editUser:i,onEditingUser:s,createUser:c,onDeletingUser:l}=A(),d=!!t,p=r||d,[x,k]=n.exports.useState(!1),[g,v]=n.exports.useState(""),S=Rt(),m=Te({defaultValues:Se(),resolver:We(Br)}),M=()=>{m.reset(Se()),a(!1),s(null)},W=b=>{k(!0);const U={edited:i,created:c},_=d?"edited":"created";v(null);let B={...b,proxies:Tr(b.proxies,t==null?void 0:t.proxies)};U[_](B).then(()=>{S({title:`User ${b.username} ${_}.`,status:"success",isClosable:!0,position:"top",duration:3e3}),M()}).catch(C=>{var pe,he,ue,me,fe;(((pe=C==null?void 0:C.response)==null?void 0:pe.status)===409||((he=C==null?void 0:C.response)==null?void 0:he.status)===400)&&v((me=(ue=C==null?void 0:C.response)==null?void 0:ue._data)==null?void 0:me.detail),((fe=C==null?void 0:C.response)==null?void 0:fe.status)===422&&Object.keys(C.response._data.detail).forEach(ge=>{m.setError(ge,{type:"custom",message:C.response._data.detail[ge]})})}).finally(()=>{k(!1)})};n.exports.useEffect(()=>{t&&(console.log(we(t)),m.reset(we(t)))},[t]);const h=x;return o(re,{isOpen:p,onClose:M,size:"2xl",children:[e(oe,{bg:"blackAlpha.300",backdropFilter:"blur(10px)"}),e(ae,{mx:"3",children:o("form",{onSubmit:m.handleSubmit(W),children:[e(ne,{pt:6,children:o(w,{gap:2,children:[e(de,{color:"primary",children:d?e(Ar,{color:"white"}):e(Fr,{color:"white"})}),o(f,{fontWeight:"semibold",fontSize:"lg",children:[d?"Edit":"Create new"," user"]})]})}),e(se,{mt:3,disabled:h}),o(le,{children:[o(Fe,{columns:{base:1,md:2},spacing:3,mt:4,children:[o(T,{justifyContent:"space-between",children:[o(T,{gap:1,gridAutoRows:"min-content",w:"full",children:[o(R,{children:[e(F,{children:"Username"}),e(Z,{size:"sm",type:"text",borderRadius:"6px",error:(D=m.formState.errors.username)==null?void 0:D.message,disabled:h||d,...m.register("username")})]}),o(R,{children:[e(F,{children:"Bandwidth Limit"}),e(q,{control:m.control,name:"data_limit",render:({field:b})=>{var U;return e(Z,{endAdornment:"GB",type:"number",size:"sm",borderRadius:"6px",onChange:_=>{b.onChange(_&&_.length?Number((parseFloat(_)*1073741824).toFixed(3)):0)},disabled:h,error:(U=m.formState.errors.data_limit)==null?void 0:U.message,value:b.value?String(b.value/1073741824):void 0})}})]}),o(R,{children:[e(F,{children:"Expiry Date"}),e(q,{name:"expire",control:m.control,render:({field:b})=>{var _;function U(B){return y(y(B*1e3).utc().format("MMMM D, YYYY")).toDate()}return o($,{children:[e(Ft,{dateFormat:"MMMM d, yyy",minDate:new Date,selected:b.value?U(b.value):void 0,onChange:B=>{b.onChange({target:{value:B?y(y(B).set("hour",23).set("minute",59).set("second",59)).utc().valueOf()/1e3:0,name:"expire"}})},customInput:e(Z,{size:"sm",type:"text",borderRadius:"6px",clearable:!0,disabled:h,error:(_=m.formState.errors.expire)==null?void 0:_.message})}),b.value?e(At,{children:$e(b.value)}):""]})}})]})]}),g&&o(K,{status:"error",display:{base:"none",md:"flex"},children:[e(J,{}),g]})]}),o(R,{isInvalid:!!((N=m.formState.errors.proxies)!=null&&N.message),children:[e(F,{children:"Protocols"}),e(q,{control:m.control,name:"proxies",render:({field:b})=>e(Ur,{list:[{title:"vmess",description:"Fast and secure"},{title:"vless",description:"Lightweight, fast and secure"},{title:"trojan",description:"Lightweight, secure and lightening fast"},{title:"shadowsocks",description:"Fast and secure, but not efficient as others"}],disabled:h,...b})}),e(Ae,{children:(V=m.formState.errors.proxies)==null?void 0:V.message})]})]}),g&&o(K,{mt:"3",status:"error",display:{base:"flex",md:"none"},children:[e(J,{}),g]})]}),e(Be,{mt:"3",children:o(w,{justifyContent:"space-between",w:"full",gap:3,children:[e(w,{children:d&&e($,{children:e(G,{label:"Delete",placement:"top",children:e(E,{"aria-label":"Delete",size:"sm",onClick:()=>l(t),children:e(Ne,{})})})})}),o(w,{w:"full",maxW:{lg:"50%",base:"full"},children:[e(z,{onClick:M,size:"sm",variant:"outline",w:"full",disabled:h,children:"Cancel"}),e(z,{type:"submit",size:"sm",colorScheme:"primary",leftIcon:x?e(te,{size:"xs"}):void 0,w:"full",disabled:h,children:d?"Edit user":"Create user"})]})]})})]})})]})};const Dr=u(Bt),Pr=u(Tt,{baseStyle:{w:6,h:6,color:"gray.600",_dark:{color:"white"}}}),Hr=u(Wt,{baseStyle:{w:6,h:6,color:"gray.600",_dark:{color:"white"}}}),Zr=u(Le,{baseStyle:{w:5,h:5}}),$r=()=>{const{qrcodeLinks:t,setQRCode:r}=A(),a=t!==null,[i,s]=n.exports.useState(0);return o(re,{isOpen:a,onClose:()=>{r(null)},children:[e(oe,{bg:"blackAlpha.300",backdropFilter:"blur(10px)"}),o(ae,{mx:"3",w:"fit-content",maxW:"3xl",children:[e(ne,{pt:6,children:e(de,{color:"primary",children:e(Zr,{color:"white"})})}),e(se,{mt:3}),t&&e(le,{w:"440px",display:"flex",justifyContent:"center",children:o(I,{w:"300px",children:[e(Dt,{centerPadding:"0px",centerMode:!0,slidesToShow:1,slidesToScroll:1,dots:!1,afterChange:s,onInit:()=>s(0),nextArrow:e(E,{size:"sm",position:"absolute",display:"flex !important",_before:{content:'""'},"aria-label":"next",children:e(Pr,{})}),prevArrow:e(E,{size:"sm",position:"absolute",display:"flex !important",_before:{content:'""'},"aria-label":"prev",children:e(Hr,{})}),children:t.map((l,d)=>e(w,{children:e(Dr,{mx:"auto",size:300,p:"2",level:"L",includeMargin:!1,value:l})},d))}),o(f,{display:"block",textAlign:"center",pb:3,mt:1,children:[i+1," / ",t.length]})]})})]})]})},Nr=()=>{const{onCreateUser:t}=A();return o(T,{justifyContent:"space-between",minH:"100vh",p:"6",experimental_spaceY:4,children:[o(I,{w:"full",children:[e(cr,{actions:e(z,{colorScheme:"primary",size:"sm",onClick:()=>t(!0),children:"Create user"})}),e(nr,{mt:"4"}),e(_r,{mt:"4"}),e(kr,{mt:"4"}),e(Wr,{}),e(Rr,{}),e($r,{})]}),e(Ze,{})]})},Vr=t=>n.exports.createElement("svg",{viewBox:"0 0 747 747",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},n.exports.createElement("path",{d:"M746.671 209.652V77.6572C746.671 72.9384 743.827 68.6832 739.468 66.8811C735.108 65.0738 730.093 66.0739 726.754 69.4072L579.354 216.807C577.453 202.386 570.203 189.203 559.037 179.87C547.875 170.542 533.615 165.744 519.083 166.432C504.551 167.12 490.807 173.24 480.573 183.583L414.375 249.776C412.417 235.391 405.141 222.25 393.985 212.959C382.823 203.662 368.594 198.88 354.083 199.552C339.578 200.224 325.849 206.302 315.594 216.588L274.343 257.828L19.9167 3.41515C16.5781 0.0818157 11.5625 -0.918184 7.20306 0.889149C2.84373 2.69648 0 6.94648 0 11.6651V143.649C0 146.743 1.22917 149.712 3.41667 151.899L191.843 340.339L3.41667 528.753C1.2292 530.94 0 533.909 0 537.003V668.997C0 673.716 2.84373 677.971 7.20306 679.773C11.5624 681.581 16.578 680.58 19.9167 677.247L167.317 529.847C169.285 544.233 176.561 557.358 187.718 566.65C198.869 575.947 213.098 580.728 227.603 580.066C242.103 579.404 255.838 573.342 266.098 563.071L332.295 496.874V496.879C334.259 511.264 341.535 524.395 352.691 533.686C363.853 542.977 378.082 547.759 392.587 547.092C407.093 546.421 420.822 540.348 431.077 530.066L472.327 488.826L726.754 743.239C728.941 745.427 731.91 746.656 735.004 746.656C736.535 746.661 738.056 746.359 739.473 745.77C743.832 743.963 746.671 739.708 746.671 734.989V602.994C746.671 599.901 745.442 596.932 743.254 594.744L554.827 406.318L743.254 217.904H743.259C745.447 215.717 746.676 212.748 746.676 209.654L746.671 209.652ZM23.3373 39.8118L257.844 274.318L208.328 323.818L23.3413 138.818L23.3373 39.8118ZM723.337 706.825L488.831 472.318L538.347 422.818L723.333 607.818L723.337 706.825ZM23.3373 541.825L332.097 233.078C338.764 226.719 347.624 223.172 356.843 223.172C366.056 223.172 374.916 226.719 381.588 233.078C388.151 239.641 391.838 248.548 391.838 257.828C391.838 267.114 388.151 276.016 381.588 282.577L23.3347 640.831L23.3373 541.825ZM249.604 546.575C240.755 555.419 227.864 558.872 215.781 555.638C203.703 552.398 194.265 542.961 191.027 530.883C187.792 518.8 191.245 505.91 200.089 497.06L497.076 200.074C505.92 191.23 518.811 187.772 530.893 191.011C542.971 194.246 552.409 203.678 555.648 215.76C558.888 227.839 555.434 240.73 546.591 249.572L249.604 546.575ZM723.337 204.815L414.577 513.562C407.911 519.926 399.051 523.473 389.832 523.473C380.618 523.473 371.753 519.926 365.087 513.562C358.529 506.999 354.842 498.098 354.842 488.816C354.842 479.535 358.529 470.634 365.087 464.071L723.34 105.818L723.337 204.815Z",fill:"currentColor"})),jr=L.object({username:L.string().min(1,"This field is required"),password:L.string().min(1,"This field is required")}),Or=u(Vr,{baseStyle:{strokeWidth:"10px",w:12,h:12}}),Ie=()=>{var k,g;const[t,r]=n.exports.useState(""),[a,i]=n.exports.useState(!1),s=Pt();let c=_e();const{register:l,formState:{errors:d},handleSubmit:p}=Te({resolver:We(jr)});return n.exports.useEffect(()=>{c.pathname!=="/login"&&s("/login",{replace:!0})},[]),o(T,{justifyContent:"space-between",minH:"100vh",p:"6",children:[e(w,{w:"full",justifyContent:"center",alignItems:"center",children:o(I,{w:"full",maxW:"340px",mt:"6",children:[o(T,{alignItems:"center",w:"full",children:[e(Or,{}),e(f,{fontSize:"2xl",fontWeight:"semibold",children:"Login to your account"}),e(f,{color:"gray.600",_dark:{color:"gray.400"},children:"Welcome back, please enter your details"})]}),e("form",{onSubmit:p(v=>{r("");const S=new FormData;S.append("username",v.username),S.append("password",v.password),S.append("grant_type","password"),i(!0),P("/admin/token",{method:"post",body:S}).then(({access_token:m})=>{Xt(m),s("/")}).catch(m=>{r(m.response._data.detail)}).finally(i.bind(null,!1))}),children:o(T,{mt:4,experimental_spaceY:4,children:[o(R,{children:[e(F,{children:"Username"}),e(Z,{w:"full",placeholder:"Username",...l("username"),error:(k=d==null?void 0:d.username)==null?void 0:k.message})]}),o(R,{children:[e(F,{children:"Password"}),e(Z,{w:"full",type:"password",placeholder:"Password",...l("password"),error:(g=d==null?void 0:d.password)==null?void 0:g.message})]}),t&&o(K,{status:"error",rounded:"md",children:[e(J,{}),e(Ht,{children:t})]}),e(z,{isLoading:a,type:"submit",w:"full",colorScheme:"primary",children:"Login"})]})})]})}),e(Ze,{})]})},Gr=()=>P("/admin",{headers:{Authorization:`Bearer ${ee()}`}}),Qr=Zt([{path:"/",element:e(er,{children:e(Nr,{})}),errorElement:e(Ie,{}),loader:Gr},{path:"/login/",element:e(Ie,{})}],{basename:"/dashboard/"});function Yr(){return e("main",{className:"p-8",children:e($t,{router:Qr})})}y.extend(Nt);y.extend(Vt);y.extend(jt);y.extend(Ot);Gt.createRoot(document.getElementById("root")).render(e(Q.StrictMode,{children:e(Qt,{theme:qt,children:e(Yt,{value:{fetcher:De,revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!0},children:e(Yr,{})})})}));
