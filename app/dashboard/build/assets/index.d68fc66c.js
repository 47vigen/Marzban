import{e as Te,$ as We,R as G,r as o,u as ye,m as ue,j as e,c as h,U as Pe,C as He,a as Oe,b as a,H as _,T as y,d as Ve,B as E,L as Ne,M as $e,S as je,f as Ze,g as Ce,h as R,i as Ge,I as B,k as S,l as Qe,n as Ye,o as qe,Q as ke,p as Se,W as Xe,N as Ke,E as Je,q as et,s as tt,t as me,v as $,w as rt,x as j,y as fe,z as Z,F as O,A as at,D as ot,G as nt,J as st,K as lt,O as it,P as ct,V as we,X as dt,Y as Ie,Z as _e,_ as J,a0 as pt,a1 as ht,a2 as ut,a3 as Ee,a4 as mt,a5 as ft,a6 as gt,a7 as z,a8 as L,a9 as bt,aa as xt,ab as yt,ac as Ct,ad as kt,ae as St,af as ve,ag as wt,ah as ee,ai as te,aj as re,ak as ae,al as oe,am as ne,an as Ue,ao as It,ap as _t,aq as I,ar as Et,as as Me,at as Re,au as A,av as Q,aw as vt,ax as Ut,ay as q,az as X,aA as Mt,aB as Rt,aC as zt,aD as Lt,aE as Dt,aF as Bt,aG as At,aH as Ft,aI as Tt,aJ as Wt,aK as Pt,aL as Ht,aM as Ot}from"./vendor.6c61a7f8.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))c(l);new MutationObserver(l=>{for(const i of l)if(i.type==="childList")for(const p of i.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&c(p)}).observe(document,{childList:!0,subtree:!0});function n(l){const i={};return l.integrity&&(i.integrity=l.integrity),l.referrerpolicy&&(i.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?i.credentials="include":l.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function c(l){if(l.ep)return;l.ep=!0;const i=n(l);fetch(l.href,i)}})();const Vt=Te({shadows:{outline:"0 0 0 2px var(--chakra-colors-primary-200)"},fonts:{body:"Inter,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif"},colors:{"light-border":"#d2d2d4",primary:{50:"#9cb7f2",100:"#88a9ef",200:"#749aec",300:"#618ce9",400:"#4d7de7",500:"#396fe4",600:"#3364cd",700:"#2e59b6",800:"#284ea0",900:"#224389"},gray:{750:"#222C3B"}},components:{Alert:{baseStyle:{container:{borderRadius:"6px",fontSize:"sm"}}},Select:{baseStyle:{field:{_dark:{borderColor:"gray.600"}}}},FormHelperText:{baseStyle:{fontSize:"xs"}},FormLabel:{baseStyle:{fontSize:"sm",fontWeight:"medium",mb:"1",_dark:{color:"gray.300"}}},Input:{baseStyle:{addon:{_dark:{borderColor:"gray.600",_placeholder:{color:"gray.500"}}},field:{_focusVisible:{boxShadow:"none",borderColor:"primary.200",outlineColor:"primary.200"},_dark:{borderColor:"gray.600",_placeholder:{color:"gray.500"}}}}},Table:{baseStyle:{table:{borderCollapse:"separate",borderSpacing:0},thead:{borderBottomColor:"light-border"},th:{background:"#F9FAFB",borderColor:"light-border !important",borderBottomColor:"light-border !important",borderTop:"1px solid ",borderTopColor:"light-border !important",_first:{borderLeft:"1px solid",borderColor:"light-border !important"},_last:{borderRight:"1px solid",borderColor:"light-border !important"},_dark:{borderColor:"gray.600 !important",background:"gray.750"}},td:{transition:"all .1s ease-out",borderColor:"light-border",borderBottomColor:"light-border !important",_first:{borderLeft:"1px solid",borderColor:"light-border",_dark:{borderColor:"gray.600"}},_last:{borderRight:"1px solid",borderColor:"light-border",_dark:{borderColor:"gray.600"}},_dark:{borderColor:"gray.600",borderBottomColor:"gray.600 !important"}},tr:{"&.interactive":{cursor:"pointer",_hover:{"& > td":{bg:"gray.200"},_dark:{"& > td":{bg:"gray.750"}}}},_last:{"& > td":{_first:{borderBottomLeftRadius:"8px"},_last:{borderBottomRightRadius:"8px"}}}}}}}});const K=()=>localStorage.getItem("token"),Nt=r=>{localStorage.setItem("token",r)},$t=We.create({baseURL:"/"}),ze=(r,t={})=>(K()&&(t.headers={...(t==null?void 0:t.headers)||{},Authorization:`Bearer ${K()}`}),$t(r,t)),W=ze,Le={editingUser:null,deletingUser:null,isCreatingNewUser:!1,qrcodeLinks:null,users:[],filteredUsers:[],loading:!0,filters:{search:""},onCreateUser:()=>{},onEditingUser:r=>{},onDeletingUser:r=>{},refetchUsers:()=>{},onFilterChange:r=>{},setQRCode:r=>{},deleteUser:r=>new Promise(()=>{}),createUser:r=>new Promise(()=>{}),editUser:r=>new Promise(()=>{})},De=G.createContext(Le),D=()=>o.exports.useContext(De),jt=(r,t)=>{switch(t.type){case"CreatingNewUser":return{...r,isCreatingNewUser:t.isOpen};case"EditingUser":return{...r,editingUser:t.user};case"DeletingUser":return{...r,deletingUser:t.user};case"FilterChange":return{...r,filters:t.filters};case"SetQrCode":return{...r,qrcodeLinks:t.links};default:return r}},Zt=({children:r})=>{const[t,n]=o.exports.useReducer(jt,Le),{data:c,isValidating:l,mutate:i}=ye("/users"),p=o.exports.useCallback(d=>{n({type:"CreatingNewUser",isOpen:d})},[]),s=o.exports.useCallback(()=>{i()},[]),f=o.exports.useCallback(d=>{n({type:"EditingUser",user:d})},[]),u=o.exports.useCallback(d=>{n({type:"DeletingUser",user:d})},[]),b=o.exports.useCallback(d=>{n({type:"FilterChange",filters:d})},[]),C=o.exports.useCallback(d=>(f(null),W(`/user/${d.username}`,{method:"DELETE"}).then(()=>{u(null),s(),ue("/system")})),[]),w=o.exports.useCallback(d=>W("/user/",{method:"POST",body:d}).then(()=>{f(null),s(),ue("/system")}),[]),x=o.exports.useCallback(d=>W(`/user/${d.username}`,{method:"PUT",body:d}).then(()=>{f(null),s()}),[]),m=o.exports.useCallback(d=>{n({type:"SetQrCode",links:d})},[]),U=o.exports.useMemo(()=>c?c.filter(d=>d.username.indexOf(t.filters.search)>-1):[],[t.filters,c]),F={...t,users:c||[],filteredUsers:U,loading:l,refetchUsers:s,onEditingUser:f,onDeletingUser:u,onCreateUser:p,onFilterChange:b,deleteUser:C,createUser:w,editUser:x,setQRCode:m};return e(De.Provider,{value:F,children:r})};function P(r,t=2){if(!+r)return"0 B";const n=1024,c=t<0?0:t,l=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(r)/Math.log(n));return`${parseFloat((r/Math.pow(n,i)).toFixed(c))} ${l[i]}`}const Gt=r=>{if(r)return r.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},Qt=h(Pe,{baseStyle:{w:5,h:5,position:"relative",zIndex:"2"}}),Yt=h(He,{baseStyle:{w:5,h:5,position:"relative",zIndex:"2"}}),qt=h(Oe,{baseStyle:{w:5,h:5,position:"relative",zIndex:"2"}}),Y=({title:r,content:t,icon:n})=>a(Ve,{p:6,borderWidth:"1px",borderColor:"light-border",bg:"#F9FAFB",_dark:{borderColor:"gray.600",bg:"gray.750"},borderStyle:"solid",boxShadow:"none",borderRadius:"12px",width:"full",display:"flex",justifyContent:"space-between",flexDirection:"row",children:[a(_,{alignItems:"center",experimental_spaceX:"4",children:[e(E,{p:"2",position:"relative",color:"white",_before:{content:'""',position:"absolute",top:0,left:0,bg:"primary.400",display:"block",w:"full",h:"full",borderRadius:"5px",opacity:".5",z:"1"},_after:{content:'""',position:"absolute",top:"-5px",left:"-5px",bg:"primary.400",display:"block",w:"calc(100% + 10px)",h:"calc(100% + 10px)",borderRadius:"8px",opacity:".4",z:"1"},children:n}),e(y,{color:"gray.600",_dark:{color:"gray.300"},fontWeight:"medium",textTransform:"capitalize",fontSize:"sm",children:r})]}),e(E,{fontSize:"3xl",fontWeight:"semibold",mt:"2",children:t})]}),Xt=r=>{const{data:t}=ye("/system",{revalidateIfStale:!0,revalidateOnFocus:!0,revalidateOnReconnect:!0,refreshInterval:5e3});return a(_,{justifyContent:"space-between",gap:0,experimental_spaceX:{lg:"4",md:"0"},experimental_spaceY:{lg:"0",base:"4"},display:{lg:"flex",md:"block"},...r,children:[e(Y,{title:"total users",content:t&&Gt(t.total_user),icon:e(Qt,{})}),e(Y,{title:"bandwidth usage",content:t&&P(t.incoming_bandwidth),icon:e(Yt,{})}),e(Y,{title:"memory usage",content:t&&a(_,{alignItems:"center",children:[e(y,{children:P(t.mem_used,1)}),a(y,{fontWeight:"normal",fontSize:"lg",as:"span",children:["/ ",P(t.mem_total,1)]})]}),icon:e(qt,{})})]})},Kt=h(Ne),Jt=h($e,{baseStyle:{w:"4",h:"4"}}),er=h(je,{baseStyle:{w:"4",h:"4"}}),Be=r=>{const{colorMode:t,toggleColorMode:n}=Ze(),c=Ce();return a(_,{w:"full",py:"0",position:"relative",...r,children:[c.pathname!=="/login"&&e(Kt,{to:"/login",left:"0",position:"absolute",children:e(R,{size:"sm",children:"Log out"})}),a(y,{display:"inline-block",flexGrow:1,textAlign:"center",color:"gray.500",fontSize:"xs",children:["Made with \u2764\uFE0F in"," ",e(Ge,{color:"blue.400",href:"https://github.com/gozargah",children:"Gozargah"})]}),e(B,{size:"sm","aria-label":"switch theme",onClick:n,position:"absolute",right:"0",children:t==="light"?e(Jt,{}):e(er,{})})]})},tr=({actions:r})=>a(_,{gap:2,justifyContent:"space-between",children:[e(y,{as:"h1",fontWeight:"semibold",fontSize:"2xl",children:"Users"}),r&&e(E,{children:r})]}),rr=r=>o.exports.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","data-name":"Layer 1",width:782.04441,height:701.88002,viewBox:"0 0 782.04441 701.88002",xmlnsXlink:"http://www.w3.org/1999/xlink",...r},o.exports.createElement("path",{d:"M609.48783,100.59015l-25.44631,6.56209L270.53735,187.9987,245.091,194.56079A48.17927,48.17927,0,0,0,210.508,253.17865L320.849,681.05606a48.17924,48.17924,0,0,0,58.61776,34.58317l.06572-.01695,364.26536-93.93675.06572-.01695a48.17923,48.17923,0,0,0,34.58309-58.6178l-110.341-427.87741A48.17928,48.17928,0,0,0,609.48783,100.59015Z",transform:"translate(-208.9778 -99.05999)",fill:"#f2f2f2"}),o.exports.createElement("path",{d:"M612.94784,114.00532l-30.13945,7.77236L278.68955,200.20385l-30.139,7.77223a34.30949,34.30949,0,0,0-24.6275,41.74308l110.341,427.87741a34.30946,34.30946,0,0,0,41.7431,24.62736l.06572-.01695,364.26536-93.93674.06619-.01707a34.30935,34.30935,0,0,0,24.627-41.7429l-110.341-427.87741A34.30938,34.30938,0,0,0,612.94784,114.00532Z",transform:"translate(-208.9778 -99.05999)",fill:"#fff"}),o.exports.createElement("path",{d:"M590.19,252.56327,405.917,300.08359a8.01411,8.01411,0,0,1-4.00241-15.52046l184.273-47.52033A8.01412,8.01412,0,0,1,590.19,252.56327Z",transform:"translate(-208.9778 -99.05999)",fill:"#f2f2f2"}),o.exports.createElement("path",{d:"M628.955,270.49906,412.671,326.27437a8.01411,8.01411,0,1,1-4.00241-15.52046l216.284-55.77531a8.01411,8.01411,0,0,1,4.00242,15.52046Z",transform:"translate(-208.9778 -99.05999)",fill:"#f2f2f2"}),o.exports.createElement("path",{d:"M620.45825,369.93676l-184.273,47.52032a8.01411,8.01411,0,1,1-4.00242-15.52046l184.273-47.52032a8.01411,8.01411,0,1,1,4.00241,15.52046Z",transform:"translate(-208.9778 -99.05999)",fill:"#f2f2f2"}),o.exports.createElement("path",{d:"M659.22329,387.87255l-216.284,55.77531a8.01411,8.01411,0,1,1-4.00242-15.52046l216.284-55.77531a8.01411,8.01411,0,0,1,4.00242,15.52046Z",transform:"translate(-208.9778 -99.05999)",fill:"#f2f2f2"}),o.exports.createElement("path",{d:"M650.72653,487.31025l-184.273,47.52033a8.01412,8.01412,0,0,1-4.00242-15.52047l184.273-47.52032a8.01411,8.01411,0,0,1,4.00242,15.52046Z",transform:"translate(-208.9778 -99.05999)",fill:"#f2f2f2"}),o.exports.createElement("path",{d:"M689.49156,505.246l-216.284,55.77532a8.01412,8.01412,0,1,1-4.00241-15.52047l216.284-55.77531a8.01411,8.01411,0,0,1,4.00242,15.52046Z",transform:"translate(-208.9778 -99.05999)",fill:"#f2f2f2"}),o.exports.createElement("path",{d:"M374.45884,348.80871l-65.21246,16.817a3.847,3.847,0,0,1-4.68062-2.76146L289.5963,304.81607a3.847,3.847,0,0,1,2.76145-4.68061l65.21247-16.817a3.847,3.847,0,0,1,4.68061,2.76145l14.96947,58.04817A3.847,3.847,0,0,1,374.45884,348.80871Z",transform:"translate(-208.9778 -99.05999)",fill:"#e6e6e6"}),o.exports.createElement("path",{d:"M404.72712,466.1822l-65.21247,16.817a3.847,3.847,0,0,1-4.68062-2.76146l-14.96946-58.04816A3.847,3.847,0,0,1,322.626,417.509l65.21246-16.817a3.847,3.847,0,0,1,4.68062,2.76145l14.96946,58.04817A3.847,3.847,0,0,1,404.72712,466.1822Z",transform:"translate(-208.9778 -99.05999)",fill:"#e6e6e6"}),o.exports.createElement("path",{d:"M434.99539,583.55569l-65.21246,16.817a3.847,3.847,0,0,1-4.68062-2.76145l-14.96946-58.04817a3.847,3.847,0,0,1,2.76145-4.68062l65.21247-16.817a3.847,3.847,0,0,1,4.68061,2.76146l14.96947,58.04816A3.847,3.847,0,0,1,434.99539,583.55569Z",transform:"translate(-208.9778 -99.05999)",fill:"#e6e6e6"}),o.exports.createElement("path",{d:"M863.63647,209.0517H487.31811a48.17928,48.17928,0,0,0-48.125,48.12512V699.05261a48.17924,48.17924,0,0,0,48.125,48.12507H863.63647a48.17924,48.17924,0,0,0,48.125-48.12507V257.17682A48.17928,48.17928,0,0,0,863.63647,209.0517Z",transform:"translate(-208.9778 -99.05999)",fill:"#e6e6e6"}),o.exports.createElement("path",{d:"M863.637,222.90589H487.31811a34.30948,34.30948,0,0,0-34.271,34.27093V699.05261a34.30947,34.30947,0,0,0,34.271,34.27088H863.637a34.30936,34.30936,0,0,0,34.27051-34.27088V257.17682A34.30937,34.30937,0,0,0,863.637,222.90589Z",transform:"translate(-208.9778 -99.05999)",fill:"#fff"}),o.exports.createElement("circle",{cx:694.19401,cy:614.02963,r:87.85039,fill:"#3182CE"}),o.exports.createElement("path",{d:"M945.18722,701.63087H914.63056V671.07421a11.45875,11.45875,0,0,0-22.9175,0v30.55666H861.1564a11.45875,11.45875,0,0,0,0,22.9175h30.55666V755.105a11.45875,11.45875,0,1,0,22.9175,0V724.54837h30.55666a11.45875,11.45875,0,0,0,0-22.9175Z",transform:"translate(-208.9778 -99.05999)",fill:"#fff"}),o.exports.createElement("path",{d:"M807.00068,465.71551H616.699a8.01412,8.01412,0,1,1,0-16.02823H807.00068a8.01412,8.01412,0,0,1,0,16.02823Z",transform:"translate(-208.9778 -99.05999)",fill:"#e6e6e6"}),o.exports.createElement("path",{d:"M840.05889,492.76314H616.699a8.01412,8.01412,0,1,1,0-16.02823H840.05889a8.01411,8.01411,0,1,1,0,16.02823Z",transform:"translate(-208.9778 -99.05999)",fill:"#e6e6e6"}),o.exports.createElement("path",{d:"M807.00068,586.929H616.699a8.01412,8.01412,0,1,1,0-16.02823H807.00068a8.01411,8.01411,0,0,1,0,16.02823Z",transform:"translate(-208.9778 -99.05999)",fill:"#e6e6e6"}),o.exports.createElement("path",{d:"M840.05889,613.97661H616.699a8.01412,8.01412,0,1,1,0-16.02823H840.05889a8.01412,8.01412,0,1,1,0,16.02823Z",transform:"translate(-208.9778 -99.05999)",fill:"#e6e6e6"}),o.exports.createElement("path",{d:"M574.07028,505.04162H506.72434a3.847,3.847,0,0,1-3.84278-3.84278V441.25158a3.847,3.847,0,0,1,3.84278-3.84278h67.34594a3.847,3.847,0,0,1,3.84278,3.84278v59.94726A3.847,3.847,0,0,1,574.07028,505.04162Z",transform:"translate(-208.9778 -99.05999)",fill:"#e6e6e6"}),o.exports.createElement("path",{d:"M574.07028,626.25509H506.72434a3.847,3.847,0,0,1-3.84278-3.84278V562.46505a3.847,3.847,0,0,1,3.84278-3.84278h67.34594a3.847,3.847,0,0,1,3.84278,3.84278v59.94726A3.847,3.847,0,0,1,574.07028,626.25509Z",transform:"translate(-208.9778 -99.05999)",fill:"#e6e6e6"}),o.exports.createElement("path",{d:"M807.21185,330.781H666.91017a8.01411,8.01411,0,0,1,0-16.02823H807.21185a8.01411,8.01411,0,0,1,0,16.02823Z",transform:"translate(-208.9778 -99.05999)",fill:"#ccc"}),o.exports.createElement("path",{d:"M840.27007,357.82862H666.91017a8.01411,8.01411,0,1,1,0-16.02822h173.3599a8.01411,8.01411,0,0,1,0,16.02822Z",transform:"translate(-208.9778 -99.05999)",fill:"#ccc"}),o.exports.createElement("path",{d:"M635.85911,390.6071H506.51316a3.847,3.847,0,0,1-3.84277-3.84277V285.81706a3.847,3.847,0,0,1,3.84277-3.84277H635.85911a3.847,3.847,0,0,1,3.84277,3.84277V386.76433A3.847,3.847,0,0,1,635.85911,390.6071Z",transform:"translate(-208.9778 -99.05999)",fill:"#ccc"})),Ae=r=>{let t="";return r&&(S(r*1e3).utc().isAfter(S().utc())?t="Expires "+S().to(S(r*1e3).utc()):t="Expired "+S().from(S(r*1e3).utc())),t},ar=r=>{let t=location.protocol+"//"+location.host;return{VITE_BASE_API:"/",BASE_URL:"/dashboard/",MODE:"production",DEV:!1,PROD:!0}.VITE_SUBSCRIBE_DOMAIN&&{VITE_BASE_API:"/",BASE_URL:"/dashboard/",MODE:"production",DEV:!1,PROD:!0}.VITE_SUBSCRIBE_DOMAIN.length&&(t="http://"+{VITE_BASE_API:"/",BASE_URL:"/dashboard/",MODE:"production",DEV:!1,PROD:!0}.VITE_SUBSCRIBE_DOMAIN),`${t}/sub/${r}`},or=h(rr),nr=h(Qe,{baseStyle:{w:5,h:5}}),ge=h(Ye,{baseStyle:{w:5,h:5}}),sr=h(qe,{baseStyle:{w:5,h:5}}),lr=h(ke,{baseStyle:{w:5,h:5}}),ir=h(Se,{baseStyle:{w:5,h:5}}),cr=h(Xe,{baseStyle:{strokeWidth:"2px",w:4,h:4}}),dr=h(Ke,{baseStyle:{strokeWidth:"2px",w:4,h:4}}),pr=h(Je,{baseStyle:{strokeWidth:"2px",w:4,h:4}}),hr={active:{statusColor:"green",bandWidthColor:"green"},expired:{statusColor:"gray",bandWidthColor:"gray"},limited:{statusColor:"red",bandWidthColor:"red"}},ur=({expiryDate:r,status:t})=>{let n=Ae(r);return a(O,{children:[a(at,{colorScheme:hr[t].statusColor,rounded:"full",display:"inline-flex",px:3,py:1,experimental_spaceX:2,alignItems:"center",children:[t==="active"&&e(cr,{}),t==="limited"&&e(dr,{}),t==="expired"&&e(pr,{}),e(y,{textTransform:"capitalize",fontSize:".875rem",lineHeight:"1.25rem",fontWeight:"medium",letterSpacing:"tighter",children:t})]}),r&&e(y,{display:"inline-block",fontSize:"xs",fontWeight:"medium",ml:"2",color:"gray.600",_dark:{color:"gray.400"},children:n})]})},mr=r=>{const{used:t,total:n,...c}=r,l=n===0||n===null,i=!l&&t/n*100>=100;return a(O,{children:[e(ot,{orientation:"horizontal",value:l?100:Math.min(t/n*100,100),colorScheme:i?"red":"primary",...c,children:e(nt,{h:"6px",borderRadius:"full",children:e(st,{borderRadius:"full"})})}),a(y,{fontSize:"xs",fontWeight:"medium",color:"gray.600",_dark:{color:"gray.400"},children:[P(t)," /"," ",l?e(y,{as:"span",fontFamily:"system-ui",children:"\u221E"}):P(n)]})]})},fr=r=>{const{filteredUsers:t,users:n,onDeletingUser:c,onEditingUser:l,setQRCode:i}=D(),p=t.length!==n.length,[s,f]=o.exports.useState([-1,-1,!1]);return o.exports.useEffect(()=>{s[2]&&setTimeout(()=>{f([-1,-1,!1])},1e3)},[s]),a(E,{overflowX:"auto",maxW:"100vw",children:[a(et,{...r,children:[e(tt,{children:a(me,{children:[e($,{children:"Username"}),e($,{children:"status"}),e($,{children:"banding usage"}),e($,{})]})}),e(rt,{children:t==null?void 0:t.map((u,b)=>{const C=u.links.join(`\r
`),w=ar(u.sub_token);return a(me,{className:"interactive",onClick:()=>l(u),children:[e(j,{minW:"150px",children:u.username}),e(j,{width:"350px",children:e(ur,{expiryDate:u.expire,status:u.status})}),e(j,{width:"300px",minW:"200px",children:e(mr,{used:u.used_traffic,total:u.data_limit,colorScheme:u.status==="limited"?"red":"primary"})}),e(j,{width:"150px",children:a(_,{justifyContent:"flex-end",onClick:x=>{x.preventDefault(),x.stopPropagation()},children:[e(fe,{text:w,onCopy:()=>{f([b,0,!0])},children:e("div",{children:e(Z,{label:s[0]===b&&s[1]==0&&s[2]?"Copied":"Copy Subscription Link",placement:"top",children:e(B,{"aria-label":"copy subscription link",bg:"transparent",_dark:{_hover:{bg:"gray.700"}},children:s[0]===b&&s[1]==0&&s[2]?e(ge,{}):e(sr,{})})})})}),e(fe,{text:C,onCopy:()=>{f([b,1,!0])},children:e("div",{children:e(Z,{label:s[0]===b&&s[1]==1&&s[2]?"Copied":"Copy Configs",placement:"top",children:e(B,{"aria-label":"copy configs",bg:"transparent",_dark:{_hover:{bg:"gray.700"}},children:s[0]===b&&s[1]==1&&s[2]?e(ge,{}):e(nr,{})})})})}),e(Z,{label:"QR Code",placement:"top",children:e(B,{"aria-label":"qr code",bg:"transparent",_dark:{_hover:{bg:"gray.700"}},onClick:()=>{i(u.links)},children:e(lr,{})})}),e(Z,{label:"Delete",placement:"top",children:e(B,{"aria-label":"delete",p:2,bg:"transparent",_dark:{_hover:{bg:"gray.700"}},onClick:x=>{x.preventDefault(),x.stopPropagation(),c(u)},children:e(ir,{})})})]})})]},u.username)})})]}),t.length==0&&e(gr,{isFiltered:p})]})},gr=({isFiltered:r})=>{const{onCreateUser:t}=D();return a(E,{borderWidth:"1px",borderStyle:"solid",borderTop:0,borderBottomRadius:"8px",padding:"5",_dark:{borderColor:"gray.600"},py:"8",display:"flex",alignItems:"center",flexDirection:"column",experimental_spaceY:4,children:[e(or,{maxHeight:"200px",maxWidth:"200px",_dark:{'path[fill="#fff"]':{fill:"gray.800"},'path[fill="#f2f2f2"], path[fill="#e6e6e6"], path[fill="#ccc"]':{fill:"gray.700"},'circle[fill="#3182CE"]':{fill:"primary.300"}},_light:{'path[fill="#f2f2f2"], path[fill="#e6e6e6"], path[fill="#ccc"]':{fill:"gray.300"},'circle[fill="#3182CE"]':{fill:"primary.500"}}}),e(y,{fontWeight:"medium",color:"gray.600",_dark:{color:"gray.400"},children:r?"It seems there is no user matched with what you are looking for":"There is no user added to the system"}),!r&&e(R,{size:"sm",colorScheme:"primary",onClick:()=>t(!0),children:"Create user"})]})},br=h(lt,{baseStyle:{w:4,h:4}}),xr=({...r})=>{const{loading:t,filters:n,onFilterChange:c}=D(),l=i=>{c({...n,search:i.target.value})};return e(it,{templateColumns:{lg:"repeat(3, 1fr)",base:"repeat(1, 1fr)"},gap:4,...r,children:e(ct,{colSpan:1,children:a(we,{children:[e(dt,{pointerEvents:"none",children:e(br,{})}),e(Ie,{type:"tel",placeholder:"Search",defaultValue:n.search||"",borderColor:"light-border",onChange:l}),t&&e(_e,{children:e(J,{size:"xs"})})]})})})},se=({children:r,color:t})=>e(E,{position:"relative",width:"36px",height:"36px",display:"flex",justifyContent:"center",alignItems:"center",_before:{content:'""',display:"block",position:"absolute",top:"0",left:"0",width:"calc(100%)",height:"calc(100%)",bg:`${t}.400`,opacity:".5",borderRadius:"5px",zIndex:"1",_dark:{bg:`${t}.400`}},_after:{content:'""',display:"block",position:"absolute",top:"0",left:"0",width:"calc(100% + 10px)",height:"calc(100% + 10px)",transform:"translate(-5px, -5px)",bg:`${t}.400`,opacity:".4",borderRadius:"8px",zIndex:"1",_dark:{bg:`${t}.400`}},children:e(y,{color:`${t}.500`,_dark:{color:`${t}.900`},position:"relative",zIndex:"2",children:r})}),yr=h(pt,{baseStyle:{strokeWidth:"2px",w:5,h:5}}),Cr=h(ht,{baseStyle:{strokeWidth:"2px",w:5,h:5}}),kr=({disabled:r,title:t,description:n,...c})=>{const{getCheckboxProps:l,getInputProps:i,getLabelProps:p,htmlProps:s}=mt(c);return a(E,{as:"label",children:[e("input",{...i()}),a(E,{w:"fll",position:"relative",...s,cursor:"pointer",borderRadius:"md",border:"1px solid",borderColor:"gray.200",_dark:{borderColor:"gray.600"},_checked:{bg:"gray.50",outline:"2px",boxShadow:"outline",outlineColor:"primary.500",borderColor:"transparent",fontWeight:"medium",_dark:{bg:"gray.750",borderColor:"transparent"},"& > svg":{opacity:1,"&.checked":{display:"block"},"&.unchecked":{display:"none"}},"& p":{opacity:1}},__css:{"& > svg":{opacity:.3,"&.checked":{display:"none"},"&.unchecked":{display:"block"}},"& p":{opacity:.8}},textTransform:"capitalize",px:3,py:2,fontWeight:"medium",...l(),children:[e(yr,{className:"checked",color:"primary.200",position:"absolute",right:"3",top:"3"}),e(Cr,{className:"unchecked",color:"primary.200",position:"absolute",right:"3",top:"3"}),e(y,{fontSize:"sm",color:"gray.700",_dark:{color:"gray.300"},...p(),children:t}),e(y,{fontWeight:"medium",color:"gray.600",_dark:{color:"gray.400"},fontSize:"xs",children:n})]})]})},Sr=o.exports.forwardRef(({name:r,list:t,onChange:n,disabled:c,...l},i)=>{const{getCheckboxProps:p}=ut({defaultValue:Object.keys(l.value),onChange:s=>{n({target:{value:s.reduce((f,u)=>({...f,[u]:{}}),{}),name:r}})}});return e(Ee,{ref:i,experimental_spaceY:1,alignItems:"flex-start",columns:1,spacing:1,children:t.map(s=>e(kr,{disabled:c,title:s.title,description:s.description,...p({value:s.title})},s.title))})}),wr=h(ft,{baseStyle:{w:4,h:4}}),H=G.forwardRef(({disabled:r,step:t,label:n,className:c,startAdornment:l,endAdornment:i,type:p="text",placeholder:s,onChange:f,onBlur:u,name:b,value:C,onClick:w,error:x,clearable:m=!1,...U},F)=>{const d=()=>{f&&f({target:{value:"",name:b}})},{size:T="md"}=U,V=p=="number"?wt:Ie,N=p=="number"?gt:G.Fragment,k=p=="number"?{name:b,type:p,placeholder:s,onChange:M=>{f&&f(M)},onBlur:u,value:C,onClick:w,disabled:r,flexGrow:1,size:T}:{};return a(z,{isInvalid:!!x,children:[n&&e(L,{children:n}),a(we,{size:T,w:"full",rounded:"md",_focusWithin:{outline:"2px solid",outlineColor:"primary.200"},children:[l&&e(bt,{children:l}),a(N,{...k,children:[e(V,{name:b,ref:F,step:t,className:xt(c),type:p,placeholder:s,onChange:f,onBlur:u,value:C,onClick:w,disabled:r,roundedLeft:l?"0":"md",roundedRight:i?"0":"md",flexGrow:1,_focusVisible:{outline:"none",borderTopColor:"transparent",borderRightColor:"transparent",borderBottomColor:"transparent"},_disabled:{cursor:"not-allowed"},...U}),p=="number"&&e(O,{children:a(yt,{children:[e(Ct,{}),e(kt,{})]})})]}),i&&e(St,{borderRadius:"6px",bg:"transparent",children:i}),m&&C&&C.length&&e(_e,{borderRadius:"6px",bg:"transparent",onClick:d,cursor:"pointer",children:e(wr,{})})]}),!!x&&e(ve,{children:x})]})}),Fe=h(Se,{baseStyle:{w:5,h:5}}),Ir=()=>{const[r,t]=o.exports.useState(!1),{deletingUser:n,onDeletingUser:c,deleteUser:l}=D(),i=()=>{c(null)},p=()=>{n&&(t(!0),l(n).then(i).finally(t.bind(null,!1)))};return a(ee,{isCentered:!0,isOpen:!!n,onClose:i,size:"sm",children:[e(te,{bg:"blackAlpha.300",backdropFilter:"blur(10px)"}),a(re,{mx:"3",children:[e(ae,{pt:6,children:e(se,{color:"red",children:e(Fe,{})})}),e(oe,{mt:3}),a(ne,{children:[e(y,{fontWeight:"semibold",fontSize:"lg",children:"Delete user"}),n&&a(y,{mt:1,fontSize:"sm",_dark:{color:"gray.400"},color:"gray.600",children:["Are you sure you want to delete ",e("b",{children:n.username}),"?"]})]}),a(Ue,{display:"flex",children:[e(R,{size:"sm",onClick:i,mr:3,w:"full",variant:"outline",children:"Cancel"}),e(R,{size:"sm",w:"full",colorScheme:"red",onClick:p,leftIcon:r?e(J,{size:"xs"}):void 0,children:"Delete"})]})]})]})},_r=h(It,{baseStyle:{w:5,h:5}}),Er=h(_t,{baseStyle:{w:5,h:5}}),vr=I.object({username:I.string().min(1,{message:"Required"}),proxies:I.object({vmess:I.any().nullable(),vless:I.any().nullable(),trojan:I.any().nullable(),shadowsocks:I.any().nullable()}).refine(r=>Object.keys(r).length>0,{message:"Please select at least one protocol"}),data_limit:I.number().min(0,"The minimum number is 0").nullable(),expire:I.number().nullable()}),be=()=>({proxies:{vmess:{},vless:{},trojan:{},shadowsocks:{}},data_limit:null,expire:null,username:""}),Ur=()=>{var T,V,N;const{editingUser:r,isCreatingNewUser:t,onCreateUser:n,editUser:c,onEditingUser:l,createUser:i,onDeletingUser:p}=D(),s=!!r,f=t||s,[u,b]=o.exports.useState(!1),[C,w]=o.exports.useState(""),x=Et(),m=Me({defaultValues:be(),resolver:Re(vr)}),U=()=>{m.reset(be()),n(!1),l(null)},F=k=>{b(!0);const M={edited:c,created:i},v=s?"edited":"created";w(null),M[v](k).then(()=>{x({title:`User ${k.username} ${v}.`,status:"success",isClosable:!0,position:"top",duration:3e3}),U()}).catch(g=>{var le,ie,ce,de,pe;(((le=g==null?void 0:g.response)==null?void 0:le.status)===409||((ie=g==null?void 0:g.response)==null?void 0:ie.status)===400)&&w((de=(ce=g==null?void 0:g.response)==null?void 0:ce._data)==null?void 0:de.detail),((pe=g==null?void 0:g.response)==null?void 0:pe.status)===422&&Object.keys(g.response._data.detail).forEach(he=>{m.setError(he,{type:"custom",message:g.response._data.detail[he]})})}).finally(()=>{b(!1)})};o.exports.useEffect(()=>{r&&m.reset(r)},[r]);const d=u;return a(ee,{isOpen:f,onClose:U,size:"2xl",children:[e(te,{bg:"blackAlpha.300",backdropFilter:"blur(10px)"}),e(re,{mx:"3",children:a("form",{onSubmit:m.handleSubmit(F),children:[e(ae,{pt:6,children:a(_,{gap:2,children:[e(se,{color:"primary",children:s?e(Er,{color:"white"}):e(_r,{color:"white"})}),a(y,{fontWeight:"semibold",fontSize:"lg",children:[s?"Edit":"Create new"," user"]})]})}),e(oe,{mt:3,disabled:d}),a(ne,{children:[a(Ee,{columns:{base:1,md:2},spacing:3,mt:4,children:[a(A,{justifyContent:"space-between",children:[a(A,{gap:1,gridAutoRows:"min-content",w:"full",children:[a(z,{children:[e(L,{children:"Username"}),e(H,{size:"sm",type:"text",borderRadius:"6px",error:(T=m.formState.errors.username)==null?void 0:T.message,disabled:d,...m.register("username")})]}),a(z,{children:[e(L,{children:"Bandwidth Limit"}),e(Q,{control:m.control,name:"data_limit",render:({field:k})=>{var M;return e(H,{endAdornment:"GB",type:"number",size:"sm",borderRadius:"6px",onChange:v=>{k.onChange(v&&v.length?Number((parseFloat(v)*1073741824).toFixed(3)):0)},disabled:d,error:(M=m.formState.errors.data_limit)==null?void 0:M.message,value:k.value?String(k.value/1073741824):void 0})}})]}),a(z,{children:[e(L,{children:"Expiry Date"}),e(Q,{name:"expire",control:m.control,render:({field:k})=>{var v;function M(g){return S(S(g*1e3).utc().format("MMMM D, YYYY")).toDate()}return a(O,{children:[e(vt,{dateFormat:"MMMM d, yyy",minDate:new Date,selected:k.value?M(k.value):void 0,onChange:g=>{k.onChange({target:{value:g?S(S(g).set("hour",23).set("minute",59).set("second",59)).utc().valueOf()/1e3:0,name:"expire"}})},customInput:e(H,{size:"sm",type:"text",borderRadius:"6px",clearable:!0,disabled:d,error:(v=m.formState.errors.expire)==null?void 0:v.message})}),k.value?e(Ut,{children:Ae(k.value)}):""]})}})]})]}),C&&a(q,{status:"error",display:{base:"none",md:"flex"},children:[e(X,{}),C]})]}),a(z,{isInvalid:!!((V=m.formState.errors.proxies)!=null&&V.message),children:[e(L,{children:"Protocols"}),e(Q,{control:m.control,name:"proxies",render:({field:k})=>e(Sr,{list:[{title:"vmess",description:"Fast and secure"},{title:"vless",description:"Lightweight, fast and secure"},{title:"trojan",description:"Lightweight, secure and lightening fast"},{title:"shadowsocks",description:"Fast and secure, but not efficient as others"}],disabled:d,...k})}),e(ve,{children:(N=m.formState.errors.proxies)==null?void 0:N.message})]})]}),C&&a(q,{mt:"3",status:"error",display:{base:"flex",md:"none"},children:[e(X,{}),C]})]}),e(Ue,{mt:"3",children:a(_,{justifyContent:"space-between",w:"full",gap:3,children:[e(_,{children:s&&e(O,{children:e(B,{"aria-label":"Delete",size:"sm",onClick:()=>p(m.getValues()),children:e(Fe,{})})})}),a(_,{w:"full",maxW:{lg:"50%",base:"full"},children:[e(R,{onClick:U,size:"sm",variant:"outline",w:"full",disabled:d,children:"Cancel"}),e(R,{type:"submit",size:"sm",colorScheme:"primary",leftIcon:u?e(J,{size:"xs"}):void 0,w:"full",disabled:d,children:s?"Edit user":"Create user"})]})]})})]})})]})},Mr=h(Mt),Rr=h(ke,{baseStyle:{w:5,h:5}}),zr=()=>{const{qrcodeLinks:r,setQRCode:t}=D();return a(ee,{isOpen:r!==null,onClose:()=>{t(null)},children:[e(te,{bg:"blackAlpha.300",backdropFilter:"blur(10px)"}),a(re,{mx:"3",w:"fit-content",maxW:"3xl",children:[e(ae,{pt:6,children:e(se,{color:"primary",children:e(Rr,{color:"white"})})}),e(oe,{mt:3}),r&&e(ne,{children:e(_,{flexWrap:"wrap",spacing:0,alignItems:"center",justifyContent:"center",children:r.map(l=>e(Mr,{size:180,p:"2",value:l}))})})]})]})},Lr=()=>{const{onCreateUser:r}=D();return a(A,{justifyContent:"space-between",minH:"100vh",p:"6",experimental_spaceY:4,children:[a(E,{w:"full",children:[e(tr,{actions:e(R,{colorScheme:"primary",size:"sm",onClick:()=>r(!0),children:"Create user"})}),e(Xt,{mt:"4"}),e(xr,{mt:"4"}),e(fr,{mt:"4"}),e(Ur,{}),e(Ir,{}),e(zr,{})]}),e(Be,{})]})},Dr=I.object({username:I.string().min(1,"This field is required"),password:I.string().min(1,"This field is required")}),Br=h(Rt,{baseStyle:{w:10,h:10}}),xe=()=>{var b,C;const[r,t]=o.exports.useState(""),[n,c]=o.exports.useState(!1),l=zt();let i=Ce();const{register:p,formState:{errors:s},handleSubmit:f}=Me({resolver:Re(Dr)});return o.exports.useEffect(()=>{i.pathname!=="/login"&&l("/login",{replace:!0})},[]),a(A,{justifyContent:"space-between",minH:"100vh",children:[e(_,{w:"full",justifyContent:"center",alignItems:"center",children:a(E,{w:"full",maxW:"340px",mt:"6",children:[a(A,{alignItems:"center",w:"full",children:[e(Br,{}),e(y,{fontSize:"2xl",fontWeight:"semibold",children:"Login to your account"}),e(y,{color:"gray.600",_dark:{color:"gray.400"},children:"Welcome back, please enter your details"})]}),e("form",{onSubmit:f(w=>{t("");const x=new FormData;x.append("username",w.username),x.append("password",w.password),x.append("grant_type","password"),c(!0),W("/admin/token",{method:"post",body:x}).then(({access_token:m})=>{Nt(m),l("/")}).catch(m=>{t(m.response._data.detail)}).finally(c.bind(null,!1))}),children:a(A,{mt:4,experimental_spaceY:4,children:[a(z,{children:[e(L,{children:"Username"}),e(H,{w:"full",placeholder:"Username",...p("username"),error:(b=s==null?void 0:s.username)==null?void 0:b.message})]}),a(z,{children:[e(L,{children:"Password"}),e(H,{w:"full",type:"password",placeholder:"Password",...p("password"),error:(C=s==null?void 0:s.password)==null?void 0:C.message})]}),r&&a(q,{status:"error",rounded:"md",children:[e(X,{}),e(Lt,{children:r})]}),e(R,{isLoading:n,type:"submit",w:"full",colorScheme:"primary",children:"Login"})]})})]})}),e(Be,{})]})},Ar=()=>W("/admin",{headers:{Authorization:`Bearer ${K()}`}}),Fr=Dt([{path:"/",element:e(Zt,{children:e(Lr,{})}),errorElement:e(xe,{}),loader:Ar},{path:"/login/",element:e(xe,{})}],{basename:"/dashboard/"});function Tr(){return e("main",{className:"p-8",children:e(Bt,{router:Fr})})}S.extend(At);S.extend(Ft);S.extend(Tt);S.extend(Wt);Pt.createRoot(document.getElementById("root")).render(e(G.StrictMode,{children:e(Ht,{theme:Vt,children:e(Ot,{value:{fetcher:ze,revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!0},children:e(Tr,{})})})}));
